<!DOCTYPE html>
<html lang="pt-BR" data-theme="system">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tutorial pr√°tico do Fastp (Conda) ‚Äî Guias</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="/assets/css/guides.css" />
  <link
    rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üß¨</text></svg>"/>
</head>
<body><!-- HEADER -->
  <header>
    <div class="container nav">
      <a class="brand" href="/" aria-label="P√°gina inicial">
        <span class="logo">üß¨</span>
        <strong>Christopher William Lee</strong>
      </a>
      <nav class="links" aria-label="Navega√ß√£o prim√°ria">
        <a href="/#projetos">Projetos</a>
        <a href="/#publicacoes">Publica√ß√µes</a>
        <a href="/#sobre">Sobre</a>
        <a href="/#contato">Contato</a>
        <a href="/guias/"
           class=""
           >Guias</a>
        <button class="theme-toggle" id="themeBtn" title="Alternar tema">üåó</button>
      </nav>
    </div>
  </header>

  <!-- CONTE√öDO -->
  <main class="container">
    <section class="guides-shell">
      <!-- SIDEBAR -->
      <aside class="sidebar" aria-label="√çndice dos guias">
        <details class="side-group" open>
          <summary>Ferramentas</summary>
          <a href="/guias/ferramentas/kraken2/" class="side-item ">Kraken2</a>
          <a href="/guias/ferramentas/qiime2/" class="side-item ">QIIME2</a>
          <a href="/guias/ferramentas/biobakery/" class="side-item ">BioBakery</a>
          <a href="/guias/ferramentas/sra_tools/" class="side-item ">SRA-Tools</a>
          <a href="/guias/ferramentas/git/" class="side-item ">Git</a>
          <a href="/guias/ferramentas/github/" class="side-item ">Github</a>
        </details>

        <details class="side-group" open>
          <summary>Aparadores</summary>
          <a href="/guias/aparadores/trimgalore/" class="side-item ">Trimgalore</a>
          <a href="/guias/aparadores/trimmomatic/" class="side-item ">Trimmomatic</a>
          <a href="/guias/aparadores/fastp/" class="side-item ">FASTP</a>
        </details>

        <details class="side-group">
          <summary>Ambientes e workflow</summary>
          <a href="/guias/ambientes/anaconda/" class="side-item ">Anaconda</a>
          <a href="/guias/ambientes/snakemake/" class="side-item ">Snakemake</a>
          <a href="/guias/ambientes/nextflow/" class="side-item ">Nextflow</a>
          <a href="/guias/ambientes/docker/" class="side-item ">Docker</a>
        </details>

        <details class="side-group">
          <summary>Conversor de arquivos</summary>
          <a href="/guias/conversores/bcl2fastq/" class="side-item ">BCL2fastq</a>
        </details>

        <details class="side-group">
          <summary>Plataforma</summary>
          <a href="/guias/plataforma/wsl/" class="side-item ">WSL</a>
        </details>

        <details class="side-group">
          <summary>Qualidade de dados</summary>
          <a href="/guias/qualidade/fastqc/" class="side-item ">FASTQC</a>
          <a href="/guias/qualidade/falco/" class="side-item ">FALCO</a>
          <a href="/guias/qualidade/multiqc/" class="side-item ">MULTIQC</a>
        </details>

        <details class="side-group">
          <summary>Meus projetos</summary>
          <a href="/guias/meus_projetos/google_sheets/" class="side-item ">Google Sheets</a>
        </details>

        <details class="side-group">
          <summary>Bitcoin</summary>
          <a href="/guias/bitcoin/bluewallet/" class="side-item ">Bluewallet</a>
        </details>
      </aside>


      <!-- CONTE√öDO DO MARKDOWN -->
      <section class="reader" id="reader">
        <h1>Tutorial pr√°tico do Fastp (Conda)</h1>
        <p><img src="/assets/img/fastp/fastp_logo.png" alt="Fastp logo" /></p>

<h1 id="workflow-com-fastp-pipeline-completo-de-qc-de-fastq"><u>Workflow com Fastp: pipeline completo de QC de FASTQ</u></h1>

<p style="align-text: justify">
  Fala, pessoal! Bora falar sobre o 
  <a href="https://github.com/OpenGene/fastp" target="_blank">
    <span class="tooltip"><strong>Fastp</strong>
      <span class="tooltiptext">Ferramenta ultrarr√°pida para pr√©-processamento de FASTQ.</span>
    </span>
  </a>?<br />
  Quem j√° trabalhou com dados de sequenciamento sabe a dor de cabe√ßa que pode ser
  preparar arquivos FASTQ: precisa rodar uma ferramenta pra fazer o trimming, outra pra filtrar leituras ruins,
  depois ainda conferir a qualidade com um programa separado‚Ä¶<br />
  O Fastp chegou justamente pra simplificar essa hist√≥ria. Ele junta em um √∫nico pacote 
  o que antes exigia v√°rias etapas e ferramentas como <strong>Trimmomatic</strong> e <strong>Cutadapt</strong>.
  Al√©m de ser bem mais r√°pido, ele foi pensado para pipelines modernas de bioinform√°tica.
  Com ele, voc√™ consegue fazer 
  <span class="tooltip"><strong>filtragem</strong>
    <span class="tooltiptext">Remove leituras de baixa qualidade ou contaminadas.</span>
  </span>, 
  <span class="tooltip"><strong>trimming</strong>
    <span class="tooltiptext">Corta bases de baixa qualidade nas extremidades das leituras.</span>
  </span> 
  e at√© 
  <span class="tooltip"><strong>controle de qualidade</strong>
    <span class="tooltiptext">Avalia a qualidade geral das leituras e gera estat√≠sticas detalhadas.</span>
  </span> 
  em um s√≥ comando. E o melhor:
  ao final ele gera relat√≥rios bonitos em 
  <span class="tooltip"><strong>HTML</strong>
    <span class="tooltiptext">Relat√≥rio interativo para inspe√ß√£o manual da qualidade.</span>
  </span> 
  (pra voc√™ explorar na m√£o) e em 
  <span class="tooltip"><strong>JSON</strong>
    <span class="tooltiptext">Formato estruturado para an√°lise automatizada em pipelines.</span>
  </span> 
  (perfeito pra integrar no fluxo autom√°tico).
</p>

<p>
  Resumindo: o Fastp √© tipo aquele canivete su√≠√ßo do pr√©-processamento de FASTQ.
  Depois que voc√™ se acostuma com ele, fica dif√≠cil voltar a fazer cada etapa em uma ferramenta separada.
</p>

<p>O que voc√™ vai precisar <u>antes</u>:</p>

<ul>
  <li><strong>Conda</strong> ‚Äî <a href="/guias/ambientes/anaconda/">instala√ß√£o aqui</a></li>
  <li><strong>WSL/Linux</strong> ‚Äî <a href="/guias/plataforma/wsl">tutorial aqui</a></li>
  <li><strong>SRA-Tools</strong> ‚Äî √∫til para baixar FASTQs p√∫blicos (<a href="/guias/ferramentas/sra-tools">guia</a>)</li>
</ul>

<p>
  Neste guia vamos montar um <span class="tooltip"><strong>pipeline completo de controle de qualidade</strong>
    <span class="tooltiptext">Fluxo que cobre desde a checagem inicial at√© a consolida√ß√£o final dos relat√≥rios.</span>
  </span> 
  para dados de sequenciamento, incluindo:
</p>

<ul>
  <li>Avalia√ß√£o inicial dos FASTQs (pr√©-trimming com Falco)</li>
  <li>Trimming e filtragem com Fastp</li>
  <li>Nova checagem de qualidade (p√≥s-trimming com Falco)</li>
  <li>Consolida√ß√£o final com MultiQC</li>
</ul>

<p><img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExYzc3ODZjNXE1aWp2M2x1aTViZWdxMTZ5MWJsOXlqNzRuem9rbXM4bCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/ggVzx0w0umA5ozxTfu/giphy.gif" alt="gif" width="300" style="display:block; margin:auto;" /></p>

<hr />

<h2 id="passo-a-passo">Passo a passo</h2>
<ol>
  <li><a href="#preparacao-ambiente">Prepara√ß√£o do ambiente</a></li>
  <li><a href="#avaliacao-pre-trimming">Avalia√ß√£o da qualidade (pr√©-trimming)</a></li>
  <li><a href="#trimming-fastp">Trimming e filtragem com Fastp</a></li>
  <li><a href="#avaliacao-pos-trimming">Avalia√ß√£o da qualidade (p√≥s-trimming)</a></li>
  <li><a href="#multiqc">Consolida√ß√£o dos relat√≥rios com MultiQC</a></li>
</ol>

<hr />

<h2 id="preparacao-ambiente">1. Prepara√ß√£o do ambiente</h2>

<p>Baixe e extraia os arquivos de exemplo:</p>

<pre>
wget 'https://drive.google.com/uc?export=download&amp;id=11kdJnIvsXiOn3-dRKsAz4ATokhCo-gAW' -O analise_dados.tgz
tar -xvzf analise_dados.tgz
</pre>

<blockquote class="info">
Os arquivos de exemplo disponibilizados no Drive servem apenas para facilitar a pr√°tica das aulas.  
Se preferir, voc√™ pode usar <strong><u>seus pr√≥prios dados</u></strong> ou at√© baixar FASTQs p√∫blicos pelo 
<a href="/guias/ferramentas/sra-tools/" target="_blank">SRA-Tools</a>.  
</blockquote>

<p>Crie a estrutura de pastas:</p>

<pre>
mkdir analise_dados/aula_1
cd analise_dados/aula_1

mkdir adaptadores pre_trim pos_trim
mkdir pre_trim/ pos_trim/

wget https://raw.githubusercontent.com/usadellab/Trimmomatic/main/adapters/TruSeq3-PE.fa
mv TruSeq3-PE.fa adaptadores/
mv ../meta_aula_1_L001* pre_trim/
</pre>

<p>Crie o ambiente √∫nico:</p>

<pre>
conda create -n qc -c bioconda -c conda-forge fastp falco multiqc -y
conda activate qc
</pre>

<blockquote class="info">
<strong>qc</strong> √© o nome que a gente deu e √© o nome do ambiente (vem de "quality control").  
Dentro dele voc√™ j√° ter√° <code>fastp</code>, <code>falco</code> e <code>multiqc</code>.
</blockquote>

<hr />

<h2 id="avaliacao-pre-trimming">2. Avalia√ß√£o da qualidade (pr√©-trimming)</h2>
<p>Entre na pasta <code class="language-plaintext highlighter-rouge">pre_trim</code> e rode o Falco nos FASTQs brutos:</p>

<pre>
cd pre_trim
mkdir -p results
falco *.fastq.gz -o results/
</pre>

<blockquote class="tip">
O <code>falco</code> √© um substituto ultrarr√°pido do <strong>FastQC</strong>, ideal para inspe√ß√£o inicial de qualidade.
</blockquote>

<hr />

<h2 id="trimming-fastp">3. Trimming e filtragem com Fastp</h2>

<p>Agora rode o <strong>Fastp</strong> para remover adaptadores, cortar regi√µes de baixa qualidade e descartar reads ruins:</p>

<pre>
fastp \
  -i meta_aula_1_L001_R1_001.fastq.gz \
  -I meta_aula_1_L001_R2_001.fastq.gz \
  -o ../pos_trim/meta_aula_trim_1_L001_R1_001.fastq.gz \
  -O ../pos_trim/meta_aula_trim_1_L001_R2_001.fastq.gz \
  --dont_eval_duplication \
  --cut_right --cut_right_window_size 4 --cut_right_mean_quality 20 \
  --length_required 36 \
  --average_qual 20 \
  --adapter_fasta ../adaptadores/TruSeq3-PE.fa
</pre>

<h3 id="principais-par√¢metros">Principais par√¢metros:</h3>

<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>Par√¢metro</th>
        <th>Descri√ß√£o</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>--cut_right</code></td>
        <td>Ativa corte adaptativo no fim das reads.</td>
      </tr>
      <tr>
        <td><code>--cut_right_window_size 4</code></td>
        <td>Tamanho da janela de corte din√¢mico.</td>
      </tr>
      <tr>
        <td><code>--cut_right_mean_quality 20</code></td>
        <td>Qualidade m√≠nima da janela (Q20).</td>
      </tr>
      <tr>
        <td><code>--length_required 36</code></td>
        <td>Descarta reads menores que 36 pb.</td>
      </tr>
      <tr>
        <td><code>--average_qual 20</code></td>
        <td>Remove reads com qualidade m√©dia abaixo de Q20.</td>
      </tr>
      <tr>
        <td><code>--adapter_fasta</code></td>
        <td>Arquivo com sequ√™ncias de adaptadores (ex.: TruSeq3-PE).</td>
      </tr>
    </tbody>
  </table>
</div>

<blockquote class="info">
O Fastp gera automaticamente relat√≥rios <code>.html</code> e <code>.json</code> para inspe√ß√£o e integra√ß√£o em pipelines.
</blockquote>

<hr />

<h2 id="avaliacao-pos-trimming">4. Avalia√ß√£o da qualidade (p√≥s-trimming)</h2>

<p>Agora rode o Falco nos arquivos processados:</p>

<pre>
cd ../pos_trim
mkdir -p results
falco *.fastq.gz -o results/
</pre>

<blockquote class="tip">
Compare os relat√≥rios <em>pr√©</em> e <em>p√≥s</em> trimming para validar a limpeza dos dados.
</blockquote>

<hr />

<h2 id="multiqc">5. Consolida√ß√£o dos relat√≥rios com MultiQC</h2>

<p>Use o MultiQC para juntar tudo em um √∫nico relat√≥rio:</p>

<pre>
multiqc results/ -o multiqc_report/ -c multiqc_config.yaml -m fastqc -v
</pre>

<blockquote class="tip">
Isso gera <code>multiqc_report.html</code>, que voc√™ pode abrir no navegador e visualizar todos os relat√≥rios juntos.
</blockquote>
<blockquote class="info">
N√£o sabe o que √© o MultiQC ou ficou em d√∫vida sobre o que est√° acontecendo?  
Confira o <a href="/guias/qualidade/multiqc/" target="_blank">tutorial completo do MultiQC</a>.
</blockquote>

<hr />

<h1 id="conclus√£o">Conclus√£o</h1>

<p>Voc√™ concluiu um <strong>pipeline completo de controle de qualidade</strong> para FASTQ:</p>

<ul>
  <li>Pr√©-QC com Falco</li>
  <li>Trimming e filtragem com Fastp</li>
  <li>P√≥s-QC com Falco</li>
  <li>Consolida√ß√£o com MultiQC</li>
</ul>

<p>Esse fluxo garante dados limpos, relat√≥rios organizados e <strong>reprodutibilidade</strong> do come√ßo ao fim.</p>

<p>Agora seus dados est√£o prontos para an√°lises downstream.</p>

<hr />

<h2 id="desafio">Desafio!!!</h2>

<p>E se voc√™ integrar esse fluxo em um <a href="/guias/ambientes/snakemake" target="_blank"><strong>Snakefile</strong></a> ou <a href="/guias/ambientes/snakemake" target="_blank"><strong>Nextflow pipeline</strong></a>?<br />
Isso garante ainda mais reprodutibilidade e automa√ß√£o!<br />
At√© a pr√≥xima!</p>

<p><img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExeWl3cGxwdGR2dXIydGkwNmI0ZHRocGZ2eXR1Y2llZWxoNWo2cnNrMyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/l0Iyl55kTeh71nTXy/giphy.gif" alt="gif" width="300" style="display:block; margin:auto;" /></p>

<hr />

<p>D√™ um suporte ao meu projeto. Doe um caf√©zinho ‚òï.<br />
Pix: biologolee@gmail.com<br />
Bitcoin: bc1qg7qrfhclzt3sm60en53qv8fmwpuacfaxt5v55k</p>

<p><img src="/assets/img/meus_projetos/bluewallet_qrcode.png" alt="QR Code" /></p>

<hr />

<h1 id="refer√™ncias">Refer√™ncias</h1>

<ol>
  <li><a href="https://docs.conda.io/projects/conda/en/latest/index.html/" target="_blank">Documenta√ß√£o oficial do Conda</a></li>
  <li><a href="https://github.com/ncbi/sra-tools/wiki" target="_blank">SRA-Tools (Wiki oficial)</a></li>
  <li><a href="https://github.com/OpenGene/fastp" target="_blank">fastp ‚Äî reposit√≥rio oficial</a></li>
  <li><a href="https://academic.oup.com/bioinformatics/article/34/17/i884/5093234" target="_blank">fastp: an ultra-fast all-in-one FASTQ preprocessor (Bioinformatics, 2018)</a></li>
  <li><a href="https://bioconda.github.io/recipes/fastp/README.html" target="_blank">Pacote fastp no Bioconda</a></li>
  <li><a href="https://github.com/smithlabcode/falco" target="_blank">Falco ‚Äî reposit√≥rio oficial</a></li>
  <li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7845152/" target="_blank">Falco: high-speed FastQC emulation (Nucleic Acids Research, 2021)</a></li>
  <li><a href="https://multiqc.info/" target="_blank">MultiQC ‚Äî site oficial</a></li>
</ol>

      </section>
    </section>
  </main>

  <button id="btn-top" aria-label="Voltar ao topo">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
      <path d="M12 4l-7 7h4v9h6v-9h4z"/>
    </svg>
    <span class="tooltip">Voltar ao topo</span>
  </button>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">¬© <span id="year"></span> Christopher William Lee ‚Äî Guias</div>
  </footer>
  
  <script src="/assets/js/main.js"></script>
</body>
</html>
